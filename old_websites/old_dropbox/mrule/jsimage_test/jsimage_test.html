<html>
<head>
<script src="math.js" type="text/javascript"></script>
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css">
.item { 
    -moz-user-select: -moz-none;
    -khtml-user-select: none;
    -webkit-user-select: none;
    -o-user-select: none;
    user-select: none;}
div {
width: 100%; 
height: 100%;
padding: 0;
margin:0;
position: absolute; 
top: 0; 
right: 0; 
bottom: 0; 
left: 0;} 
* { margin:0; padding:0; }
</style>
</head>
<body onload="imagetest()" bgcolor="#000">
<canvas id="canvas" width="500" height="500">Sorry, your browser does not support JavaScript canvas, or Javascript is disabled.</canvas>
<script type="application/javascript">

/** As far a I can tell this is how you do println in Javascript? */
function print(msg){setTimeout(function(){throw new Error(msg);},0);}
function imagetest(img){
    var W  = window.innerWidth;
    var H  = window.innerHeight;
	var canvas=document.getElementById("canvas");
    canvas.width  = W; 
    canvas.height = H; 
    var ctx = canvas.getContext('2d');
    //ctx.drawImage(img, 0, 0); 
    var imageData = ctx.getImageData(0,0,W,H);
    var buf  = new ArrayBuffer(imageData.data.length);
    var buf8 = new Uint8ClampedArray(buf);
    var data = new Uint32Array(buf);
	
    function render() {
	    for (var y=0; y<H; ++y) {
	        for (var x=0; x<W; ++x) {
	            i = y*W+x;
				data[i]=0xffff00ff;//000000|~data[i];
			}
		}
	    ctx.putImageData(imageData,0,0);
		print('image should be inverted?');
		//setTimeout(render,100);
	}
	setTimeout(render,100);
}
function load() {
	var img=new Image();
	img.onload = function() { imagetest(img); }
	img.src= "PxAx3uO.jpg";
}
</script>
</body>