<html>
<head>
<script type="text/javascript" src="jquery-1.2.6.js"></script>
<script type="text/javascript" src="jquery-ui-1.6rc2.js"></script>
<script>
R=0, G=1, B=2, A=3, W=512, H=512
N = 5
t = 0
K = 60
sc = 2*Math.PI/H
hs = W*0.5

qos = new Array();
for (i=0;i<16;i++)
    qos[i]=Math.cos(i/16.0*2*Math.PI)

function quasi(data) {
    p = t*16/K
    cT = new Array()
    sT = new Array()
    for (k = 0; k<N; k++) {
        theta = k*Math.PI/N
        cT[k] = Math.cos(theta)*sc*50
        sT[k] = Math.sin(theta)*sc*50
    }
    for (row=0; row<H; row++) {
        x = row-hs
        j = row*W     
        for (col=0; col<W; col++) {
            s = 0
            for (k = 0; k<N; k++)
                s += qos[Math.floor(cT[k]*x-sT[k]*(col-hs)+p+500)%16]
            i = (j+col)*4
            data[i+R]=data[i+G]=data[i+B]=255*(1-Math.abs(s)/N)
        }
    }
}

function draw() {
  try {
    canvas  = document.getElementById("canvas")
    context = canvas.getContext('2d')
    img     = context.createImageData(W,H)
    
    for (row=0; row<H; row++)
        for (col=0; col<W; col++)
            img.data[(row*W+col)*4+A]=255

    quasi(img.data)
    context.putImageData(img,0,0)
  }
  catch(err) { 
    alert(err)
  }
  t=(t+1)%K
}

function start() {
    setInterval(draw,50);
}

</script>
</head>
<body onLoad="start();">
<canvas id="canvas" width="512" height="512" onMouseDown="draw();" canvas aint working</canvas>
<img id="image" src="../9.jpg" width=0px;/>
</body>
</html>
